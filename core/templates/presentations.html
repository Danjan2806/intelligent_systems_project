{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="hero py-5">
    <div class="container text-center">
        <h1 class="fs-3 fs-md-2 fs-lg-1">Презентации</h1>
        <p class="fs-6 fs-md-5 fs-lg-4">Все материалы по дисциплине "Интеллектуальные системы и технологии"</p>
    </div>
</section>

<div class="container mt-5">
    <div class="row g-4">
        {% for presentation in presentations %}
        <div class="col-12 col-sm-6 col-md-4">
            <div class="glass-card text-center p-3 h-100 d-flex flex-column">
                <h4>{{ presentation.title }}</h4>
                {% if presentation.preview_image %}
                <img src="{{ presentation.preview_image.url }}" alt="{{ presentation.title }}" class="img-fluid rounded mb-3" style="height:180px; object-fit:cover;">
                {% endif %}
                <p class="flex-grow-1">{{ presentation.description }}</p>
            
                <div class="mt-3 d-flex justify-content-center gap-2 flex-wrap">
                    <button class="btn btn-custom btn-sm" onclick="openPopup('{{ presentation.file.url }}')">Просмотр</button>
                    <a href="{{ presentation.file.url }}" download class="btn btn-outline-light btn-sm">Скачать</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Popup overlay -->
<div id="popupOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
     background:rgba(0,0,0,0.8); z-index:1050; justify-content:center; align-items:center; padding:10px; box-sizing:border-box;">
    <div style="position:relative; width:100%; max-width:1200px; height:80%; max-height:1000px; background:#fff; border-radius:10px; overflow:hidden;">
        <button onclick="closePopup()" 
                style="position:absolute; top:10px; right:10px; z-index:10;" 
                class="btn btn-danger btn-sm">✖</button>
        <iframe id="popupFrame" src="" width="100%" height="100%" style="border:none;"></iframe>
    </div>
</div>

<script>
function openPopup(url) {
    const overlay = document.getElementById('popupOverlay');
    const frame = document.getElementById('popupFrame');
    frame.src = url;
    overlay.classList.remove('d-none');
    overlay.style.display = 'flex';
}

function closePopup() {
    const overlay = document.getElementById('popupOverlay');
    const frame = document.getElementById('popupFrame');
    frame.src = '';
    overlay.classList.add('d-none');
    overlay.style.display = 'none';
}
</script>

{% endblock %}